<Window x:Class="CalibrationTool.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:CalibrationTool"
        mc:Ignorable="d" Closed="Window_Closed"
        Title="MFD校准工具" Height="600" Width="800">
    <DockPanel>
        <!--菜单栏-->
        <Menu DockPanel.Dock="Top">
            <MenuItem Header="文件"></MenuItem>
        </Menu>
        
        <!--状态栏--><!--
        <StatusBar DockPanel.Dock="Bottom"
                   Background="LightGray"
                   Height="24">
            <StatusBarItem>准备就绪</StatusBarItem>
        </StatusBar>-->
        
        <!--内容区域-->
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="2*"/>
            </Grid.ColumnDefinitions>
            
            <!--左侧Tab-->
            <TabControl MinWidth="200" Margin="4">
                <TabItem Header="串口" Name="SerialPortTabItem">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Label Grid.Row="0" Grid.Column="0" Margin="0,4,4,0" 
                               HorizontalContentAlignment="Center">串口</Label>
                        <ComboBox Grid.Row="0" Grid.Column="1" Margin="0,4,4,0"
                              ItemsSource="{Binding PortNameCollection}"
                              SelectedIndex="0"
                              SelectedItem="{Binding PortName}"></ComboBox>
                        <Label Grid.Row="1" Grid.Column="0" Margin="0,4,4,0" 
                               HorizontalContentAlignment="Center">波特率</Label>
                        <ComboBox Grid.Row="1" Grid.Column="1" Margin="0,4,4,0"
                              ItemsSource="{Binding BaudRateCollection}"
                              SelectedIndex="0"
                              SelectedItem="{Binding BaudRate}"></ComboBox>
                        <Label Grid.Row="2" Grid.Column="0" Margin="0,4,4,0"
                               HorizontalContentAlignment="Center">数据位</Label>
                        <ComboBox Grid.Row="2" Grid.Column="1" Margin="0,4,4,0"
                              ItemsSource="{Binding DataBitsCollection}"
                              SelectedIndex="0"
                              SelectedItem="{Binding DataBits}"></ComboBox>
                        <Label Grid.Row="3" Grid.Column="0" Margin="0,4,4,0"
                               HorizontalContentAlignment="Center">校验位</Label>
                        <ComboBox Grid.Row="3" Grid.Column="1" Margin="0,4,4,0"
                              ItemsSource="{Binding ParityCollection}"
                              SelectedIndex="0"
                              SelectedItem="{Binding Parity}"></ComboBox>
                        <Label Grid.Row="4" Grid.Column="0" Margin="0,4,4,0" 
                               HorizontalContentAlignment="Center">停止位</Label>
                        <ComboBox Grid.Row="4" Grid.Column="1" Margin="0,4,4,0"
                              ItemsSource="{Binding StopBitsCollection}"
                              SelectedIndex="0"
                              SelectedItem="{Binding StopBits}"></ComboBox>
                        <GroupBox Grid.Row="5" Grid.ColumnSpan="2" 
                                  Header="接收设置" Margin="0,4,4,0">
                            <StackPanel>
                                <RadioButton Content="ASCII"/>
                                <RadioButton Content="Hex"/>
                                <CheckBox Content="自动换行"/>
                            </StackPanel>
                        </GroupBox>
                        <GroupBox Grid.Row="6" Grid.ColumnSpan="2" 
                                  Header="发送设置" Margin="0,4,4,0">
                            <StackPanel>
                                <RadioButton Content="ASCII"/>
                                <RadioButton Content="Hex"/>
                            </StackPanel>
                        </GroupBox>
                    </Grid>
                </TabItem>
                
                <TabItem Header="DEBUG" Name="DebugTabItem">
                    <Button Width="150" Height="30" 
                            Command="{Binding DebugCommand}">获取信息</Button>
                </TabItem>
                
                <TabItem Header="VOLT/K">
                    <StackPanel Orientation="Vertical">
                        <Button Margin="4">打开Excel文件</Button>
                        <Label>VOLT:</Label>
                        <TextBox Margin="4" Height="100"
                                 TextWrapping="Wrap"
                                 VerticalScrollBarVisibility="Auto"></TextBox>
                        <Button Margin="4">写入VOLT</Button>
                        <Label>K:</Label>
                        <TextBox Margin="4" Height="100"
                                 TextWrapping="Wrap"
                                 VerticalScrollBarVisibility="Auto"></TextBox>
                        <Button Margin="4">写入K</Button>
                    </StackPanel>
                </TabItem>
                
                <TabItem Header="GAS"></TabItem>
                
                <TabItem Header="REF"></TabItem>
                
                <TabItem Header="读流量" Name="ReadFlowTabItem">
                    <StackPanel Orientation="Vertical">
                        <CheckBox Margin="4" IsChecked="{Binding Repeat}">重复</CheckBox>
                        <Label>时间间隔(ms):</Label>
                        <TextBox Margin="4" Text="{Binding Interval}"></TextBox>
                        <Button Margin="4" Command="{Binding SendCommand}">发送</Button>
                    </StackPanel>
                </TabItem>
                
            </TabControl>
            
            <Grid Grid.Column="1" Name="ContentGrid">
                <Grid.RowDefinitions>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                <TextBox Margin="4"
                         Name="DisplayTextBox"
                         IsReadOnly="True"
                         Text="{Binding ReceivedData, Mode=OneWay}"
                         VerticalScrollBarVisibility="Auto"
                         TextChanged="DisplayTextBox_TextChanged"></TextBox>
                <StackPanel Orientation="Vertical" Grid.Column="1">
                    <Button Margin="4" Command="{Binding ClearDisplayCommand}">清除</Button>
                    <Button Margin="4" Command="{Binding CopyDisplayContentCommand}">复制</Button>
                </StackPanel>
                <TextBox Grid.Row="1" Height="100" Margin="4"></TextBox>
                <Button Grid.Row="1" Grid.Column="1" 
                        Height="30" Margin="4">发送</Button>
            </Grid>
        </Grid>
    </DockPanel>
</Window>
